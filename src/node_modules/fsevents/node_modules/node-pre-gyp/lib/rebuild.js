"use strict";

module.exports = exports = rebuild;

exports.usage = 'Runs "clean" and "build" at once';

var fs = require('fs');
var napi = require('./util/napi.js');

function rebuild (gyp, argv, callback) {
  var package_json = JSON.parse(fs.readFileSync('./package.json'));
  var commands = [
    { name: 'clean', args: [] },
    { name: 'build', args: ['rebuild'] }
    ];
<<<<<<< HEAD
  commands = napi.expand_commands(package_json, gyp.opts, commands);
=======
  commands = napi.expand_commands(package_json, commands);
>>>>>>> 40b68b803b32f109350a2917c9a607927080fd74
  for (var i = commands.length; i !== 0; i--) {
    gyp.todo.unshift(commands[i-1]);
  }
  process.nextTick(callback);
}
